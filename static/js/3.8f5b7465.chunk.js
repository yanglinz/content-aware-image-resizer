(this["webpackJsonprust-wasm-seam-carving"]=this["webpackJsonprust-wasm-seam-carving"]||[]).push([[3],{1:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n(7),i=n(12),c=n(8),o=n(4);var s=n(9),l=n(17),u=n(3),d=["children","intent"];var f=function(e){var t=e.children,n=e.intent,r=Object(l.a)(e,d);return"PRIMARY"===n?Object(u.jsx)("button",Object(s.a)(Object(s.a)({className:"drop-shadow\tpx-5 font-large py-3 text-white text-base bg-blue-500 hover:bg-blue-600 border border-gray-300 rounded-md focus:outline-none disabled:opacity-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"},r),{},{children:t})):"SECONDARY"===n?Object(u.jsx)("button",Object(s.a)(Object(s.a)({className:"drop-shadow\tpx-5 font-large py-3 text-gray-700 text-base hover:bg-gray-50 bg-white border border-gray-300 rounded-md focus:outline-none disabled:opacity-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"},r),{},{children:t})):null};function h(e){return c.a.createPortal(e.children,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dialog-mount",t=document.getElementById(e);return t||((t=document.createElement("div")).id=e,document.body.appendChild(t)),t}())}function g(e){return Object(u.jsx)(h,{children:Object(u.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",role:"dialog","aria-modal":"true",children:Object(u.jsxs)("div",{className:"flex items-end justify-center pb-20 pt-4 px-4 min-h-screen text-center sm:block sm:p-0",children:[Object(u.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),Object(u.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),Object(u.jsx)("div",{className:"inline-block align-bottom text-left bg-white rounded-sm shadow-xl overflow-hidden transform transition-all sm:align-middle sm:my-8 sm:w-full sm:max-w-lg",children:e.children})]})})})}var m=function(e){var t=e.globalState,n=e.handleImageSelect,a=e.handleClose;if("IMAGE_SELECT"!==t.control.state)return null;var i=[["yRjLihK35Yw","title"],["e-S-Pe2EmrE","Birds in the sky"],["F6XKjhMNB14","Waves on a beach"],["KGwK6n7rxSg","Hot balloons"],["C9XgrB8hqBI","Top down shot of beach"],["pVr6wvUneMk","Desert landscape"],["Pn6iimgM-wo","Light house at night"],["4Oi1756LtF4","Castle"]].map((function(e){var t=Object(r.a)(e,2),n=t[0];return{alt:t[1],url:"https://source.unsplash.com/".concat(n,"/1000x500"),previewUrl:"https://source.unsplash.com/".concat(n,"/200x150")}}));return Object(u.jsxs)(g,{children:[Object(u.jsx)("div",{className:"pb-4 pt-5 px-4 bg-white sm:p-6 sm:pb-4",children:Object(u.jsxs)("div",{className:"flex flex-col content-center items-center",children:[Object(u.jsx)("h3",{className:"my-3 text-gray-900 text-lg font-medium leading-6",children:"Select Image"}),Object(u.jsx)("div",{className:"grid gap-1 grid-cols-4 overflow-hidden",children:i.map((function(e){return Object(u.jsx)("img",{className:"inline-block w-20 h-20 rounded-full",onClick:function(){return n(e.url)},alt:e.alt,src:e.previewUrl})}))})]})}),Object(u.jsx)("div",{className:"px-4 py-3 bg-gray-50 sm:flex sm:flex-row-reverse sm:px-6",children:Object(u.jsx)(f,{intent:"SECONDARY",onClick:a,children:"Cancel"})})]})};function b(){return{source:document.getElementById("canvas-source"),target:document.getElementById("canvas-target")}}var v=function(e){var t=e.globalState.selectedImage,n="SOURCE"===t.state?"":"hidden",r="TARGET"===t.state?"":"hidden";return Object(u.jsxs)("div",{className:"border-8 border-gray-600 border-opacity-5",children:[Object(u.jsx)("div",{className:n,children:Object(u.jsx)("canvas",{id:"canvas-source"})}),Object(u.jsx)("div",{className:r,children:Object(u.jsx)("canvas",{id:"canvas-target"})})]})};function j(e){var t=e.minWidth,n=e.maxWidth,i=e.disabled,c=e.onChange,o=Object(a.c)(n),l=Object(r.a)(o,2),d=l[0],f=l[1],h={disabled:!0};return i||(h={min:t,max:n,value:d,onChange:function(e){var t=parseInt(e.target.value);f(t),c(t)}}),Object(u.jsx)("div",{className:"flex justify-center",children:Object(u.jsxs)("div",{className:"align-center flex w-11/12 sm:w-8/12",children:[Object(u.jsx)("input",Object(s.a)({id:"resize",name:"resize",type:"range",className:"flex-grow"},h)),Object(u.jsxs)("label",{className:"w-20 text-right text-gray-700 font-mono",for:"resize",children:[i?0:d,"px"]})]})})}var p,x=function(e){var t=e.globalState,n=e.handleResize,i=e.handleOpenImageSelect,c=t.selectedImage,o=Object(a.c)(0),s=Object(r.a)(o,2),l=s[0],d=s[1],h="SOURCE"===c.state&&0!==l&&l!==c.width;return Object(u.jsxs)("div",{className:"Controls",children:[Object(u.jsx)("div",{className:"pb-3",children:Object(u.jsx)(j,{disabled:"SOURCE"!==c.state,minWidth:20,maxWidth:c.width,onChange:d},c.url)}),Object(u.jsx)("div",{className:"flex justify-center",children:Object(u.jsxs)("div",{className:"flex",children:[Object(u.jsx)(f,{intent:"PRIMARY",disabled:!h,onClick:function(){return n(l)},children:"Resize Image"}),Object(u.jsx)("div",{className:"px-1"}),Object(u.jsx)(f,{intent:"SECONDARY",onClick:i,children:"Try Another Image"})]})})]})},y=(n(11),{selectedImage:{state:"INITIAL",url:null,width:0,height:0},control:{state:"INITIAL"}}),O={SOURCE_IMAGE_LOADED:function(e,t){var n=t.payload,r=n.width,a=n.height,i=n.url;e.selectedImage.state="SOURCE",e.selectedImage.width=r,e.selectedImage.height=a,e.selectedImage.url=i},RESIZE_INITIALIZED:function(e,t){e.selectedImage.state="TARGET"},IMAGE_SELECT_OPENED:function(e,t){e.control.state="IMAGE_SELECT"},IMAGE_SELECT_CLOSED:function(e,t){e.control.state="INITIAL"}};function w(e,t){var n=O[t.type];if(!n)throw new Error("Unknown action type in reducer.");return Object(i.a)(e,(function(e){return n(e,t)}))}function E(){var e=Object(a.b)(w,y),t=Object(r.a)(e,2),n=t[0],i=t[1];function c(e){var t=b().source;return fetch(e).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e)})).then((function(n){t.width=n.width,t.height=n.height;var r=t.getContext("2d");r.drawImage(n,0,0,n.width,n.height,0,0,t.width,t.height);r.getImageData(0,0,t.width,t.height);i({type:"SOURCE_IMAGE_LOADED",payload:{width:t.width,height:t.height,url:e}})}))}return Object(a.a)((function(){return c("https://source.unsplash.com/yRjLihK35Yw/500x250")}),[]),Object(u.jsxs)("div",{className:"App flex flex-col h-screen",children:[Object(u.jsx)("div",{className:"flex-grow",children:Object(u.jsx)("div",{className:"flex items-center\tjustify-center h-full",children:Object(u.jsx)(v,{globalState:n})})}),Object(u.jsx)("div",{className:"border-t border-gray-150 p-10 bg-white",children:Object(u.jsx)(x,{globalState:n,handleResize:function(e){var t=b(),n=t.source,r=t.target,a=o.a.from_canvas(n.getContext("2d"),n.width,n.height);function c(){var e=a.image_data_ptr(),t=new Uint8ClampedArray(Object(o.k)().buffer,e,a.width*a.height*4);r.width=a.width,r.height=a.height;var n=new ImageData(t,a.width,a.height);r.getContext("2d").putImageData(n,0,0)}var s=n.width-e;requestAnimationFrame((function e(){s<=0||(a.mark_seam(),c(),requestAnimationFrame((function(){a.delete_seam(),c(),s-=1,requestAnimationFrame(e)})))})),i({type:"RESIZE_INITIALIZED"})},handleOpenImageSelect:function(){return i({type:"IMAGE_SELECT_OPENED"})}})}),Object(u.jsx)(m,{globalState:n,handleImageSelect:function(e){c(e),i({type:"IMAGE_SELECT_CLOSED"})},handleClose:function(){return i({type:"IMAGE_SELECT_CLOSED"})}})]})}p=function(){c.a.render(Object(u.jsx)(E,{}),document.getElementById("app"))},"loading"!=document.readyState?p():document.addEventListener("DOMContentLoaded",p)},11:function(e,t,n){},16:function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(4);r.t()},4:function(e,t,n){"use strict";(function(e){n.d(t,"k",(function(){return E})),n.d(t,"a",(function(){return _})),n.d(t,"i",(function(){return N})),n.d(t,"d",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"e",(function(){return A})),n.d(t,"f",(function(){return k})),n.d(t,"c",(function(){return T})),n.d(t,"g",(function(){return D})),n.d(t,"j",(function(){return L})),n.d(t,"h",(function(){return R}));var r=n(14),a=n(15),i=n(16),c=new Array(32).fill(void 0);function o(e){return c[e]}c.push(void 0,null,!0,!1);var s=c.length;function l(e){var t=o(e);return function(e){e<36||(c[e]=s,s=e)}(e),t}function u(e){var t=typeof e;if("number"==t||"boolean"==t||null==e)return"".concat(e);if("string"==t)return'"'.concat(e,'"');if("symbol"==t){var n=e.description;return null==n?"Symbol":"Symbol(".concat(n,")")}if("function"==t){var r=e.name;return"string"==typeof r&&r.length>0?"Function(".concat(r,")"):"Function"}if(Array.isArray(e)){var a=e.length,i="[";a>0&&(i+=u(e[0]));for(var c=1;c<a;c++)i+=", "+u(e[c]);return i+="]"}var o,s=/\[object ([^\]]+)\]/.exec(toString.call(e));if(!(s.length>1))return toString.call(e);if("Object"==(o=s[1]))try{return"Object("+JSON.stringify(e)+")"}catch(l){return"Object"}return e instanceof Error?"".concat(e.name,": ").concat(e.message,"\n").concat(e.stack):o}var d=0,f=null;function h(){return null!==f&&f.buffer===i.l.buffer||(f=new Uint8Array(i.l.buffer)),f}var g=new("undefined"===typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8"),m="function"===typeof g.encodeInto?function(e,t){return g.encodeInto(e,t)}:function(e,t){var n=g.encode(e);return t.set(n),{read:e.length,written:n.length}};function b(e,t,n){if(void 0===n){var r=g.encode(e),a=t(r.length);return h().subarray(a,a+r.length).set(r),d=r.length,a}for(var i=e.length,c=t(i),o=h(),s=0;s<i;s++){var l=e.charCodeAt(s);if(l>127)break;o[c+s]=l}if(s!==i){0!==s&&(e=e.slice(s)),c=n(c,i,i=s+3*e.length);var u=h().subarray(c+s,c+i);s+=m(e,u).written}return d=s,c}var v=null;function j(){return null!==v&&v.buffer===i.l.buffer||(v=new Int32Array(i.l.buffer)),v}var p=new("undefined"===typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});function x(e,t){return p.decode(h().subarray(e,e+t))}function y(e){s===c.length&&c.push(c.length+1);var t=s;return s=c[t],c[t]=e,t}p.decode();var O=32;function w(e,t){var n=t(1*e.length);return h().set(e,n/1),d=e.length,n}function E(){return l(i.s())}function I(e,t){try{return e.apply(this,t)}catch(n){i.h(y(n))}}var _=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();i.d(e)}},{key:"width",get:function(){return i.c(this.ptr)>>>0},set:function(e){i.f(this.ptr,e)}},{key:"height",get:function(){return i.b(this.ptr)>>>0},set:function(e){i.e(this.ptr,e)}},{key:"mark_seam",value:function(){i.r(this.ptr)}},{key:"delete_seam",value:function(){i.m(this.ptr)}},{key:"image_data_ptr",value:function(){return i.p(this.ptr)}},{key:"image_data_vec",value:function(){try{var e=i.g(-16);i.q(e,this.ptr);var t=j()[e/4+0],n=j()[e/4+1],r=(a=t,c=n,h().subarray(a/1,a/1+c)).slice();return i.i(t,1*n),r}finally{i.g(16)}var a,c}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"from_canvas",value:function(t,n,r){try{var a=i.n(function(e){if(1==O)throw new Error("out of js stack");return c[--O]=e,O}(t),n,r);return e.__wrap(a)}finally{c[O++]=void 0}}},{key:"from_vec",value:function(t,n,r){var a=w(t,i.j),c=d,o=i.o(a,c,n,r);return e.__wrap(o)}}]),e}();function N(e){l(e)}function S(){return I((function(e,t,n,r,a){return y(o(e).getImageData(t,n,r,a))}),arguments)}function C(e,t){var n=w(o(t).data,i.j),r=d;j()[e/4+1]=r,j()[e/4+0]=n}function A(){return y(new Error)}function k(e,t){var n=b(o(t).stack,i.j,i.k),r=d;j()[e/4+1]=r,j()[e/4+0]=n}function T(e,t){try{console.error(x(e,t))}finally{i.i(e,t)}}function D(e,t){var n=b(u(o(t)),i.j,i.k),r=d;j()[e/4+1]=r,j()[e/4+0]=n}function L(e,t){throw new Error(x(e,t))}function R(){return y(i.l)}}).call(this,n(13)(e))}}]);
//# sourceMappingURL=3.8f5b7465.chunk.js.map